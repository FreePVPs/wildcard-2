const int inv2 = (mod+1)/2;