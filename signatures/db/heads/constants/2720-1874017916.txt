	const int n = f.size(), mask = n - 1;